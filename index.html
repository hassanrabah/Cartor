<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>تطبيق بيع وشراء سيارات - Cartor</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f7f7f7;
    margin: 0;
    padding: 0;
    text-align: center;
    color: #222;
  }
  nav {
    background: #004ba0;
    padding: 15px 0;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 100;
  }
  nav button {
    background: #ffc107;
    border: none;
    color: #222;
    padding: 10px 18px;
    margin: 0 5px;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
    font-size: 16px;
  }
  nav button:hover {
    background: #ffb300;
  }
  nav button:disabled {
    background: #ddd;
    cursor: not-allowed;
  }
  nav button.active {
    background: #ffb300;
  }
  section {
    max-width: 700px;
    margin: 30px auto;
    background: white;
    padding: 20px 30px;
    border-radius: 10px;
    box-shadow: 0 0 15px #ccc;
    display: none;
    text-align: right;
  }
  section.active {
    display: block;
  }
  h2 {
    margin-top: 0;
    color: #004ba0;
  }
  input, select {
    width: 95%;
    padding: 10px;
    margin: 8px 0 20px 0;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 16px;
  }
  button.submit-btn {
    background: #004ba0;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 8px;
    font-size: 17px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button.submit-btn:hover {
    background: #003070;
  }
  .msg {
    margin: 10px 0;
    font-weight: bold;
  }
  .msg.error {
    color: #c00;
  }
  .msg.success {
    color: #080;
  }
  .car-card {
    text-align: right;
    border-bottom: 1px solid #ddd;
    padding: 15px 0;
  }
  .car-card:last-child {
    border-bottom: none;
  }
  .car-title {
    font-weight: bold;
    font-size: 20px;
    color: #004ba0;
  }
  .car-details {
    margin-top: 6px;
    font-size: 15px;
  }
</style>
</head>
<body>

<nav>
  <button id="btnHome" class="active">الرئيسية</button>
  <button id="btnAdd" disabled>إضافة إعلان</button>
  <button id="btnLogin">تسجيل دخول</button>
  <button id="btnRegister">إنشاء حساب</button>
  <button id="btnLogout" style="display:none;">تسجيل خروج</button>
</nav>

<section id="home" class="active">
  <h2>السيارات المعروضة للبيع</h2>
  <div id="carList">
    <p>لا توجد سيارات معروضة حالياً.</p>
  </div>
</section>

<section id="add">
  <h2>إضافة إعلان سيارة جديد</h2>
  <p id="addMsg" class="msg"></p>
  <form id="addForm">
    <input type="text" id="carName" placeholder="اسم السيارة" required />
    <input type="number" id="price" placeholder="السعر (بالجنيه)" required min="1" />
    <input type="number" id="year" placeholder="سنة الصنع" required min="1900" max="2099" />
    <input type="number" id="mileage" placeholder="الكيلومترات المقطوعة" required min="0" />
    <input type="number" id="engine" placeholder="حجم المحرك (cc)" required min="50" />
    <select id="transmission" required>
      <option value="">اختر ناقل الحركة</option>
      <option value="أوتوماتيك">أوتوماتيك</option>
      <option value="عادي">عادي</option>
    </select>
    <select id="fuel" required>
      <option value="">اختر نوع الوقود</option>
      <option value="بنزين">بنزين</option>
      <option value="ديزل">ديزل</option>
      <option value="غاز طبيعي">غاز طبيعي</option>
    </select>
    <button type="submit" class="submit-btn">إضافة الإعلان</button>
  </form>
</section>

<section id="loginSection">
  <h2>تسجيل دخول</h2>
  <p id="loginMsg" class="msg"></p>
  <form id="loginForm">
    <input type="email" id="loginEmail" placeholder="البريد الإلكتروني" required />
    <input type="password" id="loginPassword" placeholder="كلمة المرور" required />
    <button type="submit" class="submit-btn">دخول</button>
  </form>
</section>

<section id="registerSection">
  <h2>إنشاء حساب جديد</h2>
  <p id="registerMsg" class="msg"></p>
  <form id="registerForm">
    <input type="email" id="regEmail" placeholder="البريد الإلكتروني" required />
    <input type="password" id="regPassword" placeholder="كلمة المرور" required minlength="6" />
    <input type="password" id="regPasswordConfirm" placeholder="تأكيد كلمة المرور" required minlength="6" />
    <button type="submit" class="submit-btn">إنشاء حساب</button>
  </form>
</section>

<script>
  // --- التبديل بين الأقسام ---
  function showSection(id) {
    ['home','add','loginSection','registerSection'].forEach(sec => {
      document.getElementById(sec).classList.remove('active');
    });
    if(id) document.getElementById(id).classList.add('active');
    clearMessages();
  }

  function clearMessages() {
    ['loginMsg','registerMsg','addMsg'].forEach(id => {
      const el = document.getElementById(id);
      el.textContent = '';
      el.className = 'msg';
    });
  }

  // --- بيانات المستخدمين ---
  function getUsers() {
    return JSON.parse(localStorage.getItem('users') || '[]');
  }
  function saveUsers(users) {
    localStorage.setItem('users', JSON.stringify(users));
  }

  // --- بيانات السيارات ---
  function getCars() {
    return JSON.parse(localStorage.getItem('cars') || '[]');
  }
  function saveCars(cars) {
    localStorage.setItem('cars', JSON.stringify(cars));
  }

  // --- عرض السيارات في الصفحة الرئيسية ---
  function renderCarList() {
    const carList = document.getElementById('carList');
    const cars = getCars();
    if(cars.length === 0) {
      carList.innerHTML = '<p>لا توجد سيارات معروضة حالياً.</p>';
      return;
    }
    let html = '';
    cars.forEach(car => {
      html += `
        <div class="car-card">
          <div class="car-title">${car.carName}</div>
          <div class="car-details">
            السعر: ${car.price.toLocaleString()} جنيه<br/>
            سنة الصنع: ${car.year}<br/>
            الكيلومترات: ${car.mileage.toLocaleString()} كم<br/>
            حجم المحرك: ${car.engine} سي سي<br/>
            ناقل الحركة: ${car.transmission}<br/>
            نوع الوقود: ${car.fuel}
          </div>
        </div>`;
    });
    carList.innerHTML = html;
  }

  // --- تحديث حالة واجهة المستخدم ---
  function updateUI() {
    const email = localStorage.getItem('userEmail');
    const loggedIn = !!email;
    document.getElementById('btnLogout').style.display = loggedIn ? 'inline-block' : 'none';
    document.getElementById('btnLogin').style.display = loggedIn ? 'none' : 'inline-block';
    document.getElementById('btnRegister').style.display = loggedIn ? 'none' : 'inline-block';
    document.getElementById('btnAdd').disabled = !loggedIn;
  }

  // --- تسجيل خروج ---
  document.getElementById('btnLogout').addEventListener('click', () => {
    localStorage.removeItem('userEmail');
    updateUI();
    showSection('home');
  });

  // --- أزرار التنقل ---
  document.getElementById('btnHome').addEventListener('click', () => showSection('home'));
  document.getElementById('btnAdd').addEventListener('click', () => {
    if(!localStorage.getItem('userEmail')) {
      alert('يجب تسجيل الدخول لإضافة إعلان');
      showSection('loginSection');
      return;
    }
    showSection('add');
  });
  document.getElementById('btnLogin').addEventListener('click', () => showSection('loginSection'));
  document.getElementById('btnRegister').addEventListener('click', () => showSection('registerSection'));

  // --- تسجيل دخول ---
  document.getElementById('loginForm').addEventListener('submit', e => {
    e.preventDefault();
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value;
    const users = getUsers();
    const user = users.find(u => u.email === email && u.password === password);
    const msg = document.getElementById('loginMsg');
    if(user) {
      localStorage.setItem('userEmail', email);
      msg.textContent = 'تم تسجيل الدخول بنجاح!';
      msg.className = 'msg success';
      updateUI();
      showSection('home');
    } else {
      msg.textContent = 'البريد الإلكتروني أو كلمة المرور غير صحيحة.';
      msg.className = 'msg error';
    }
  });

  // --- إنشاء حساب جديد ---
  document.getElementById('registerForm').addEventListener('submit', e => {
    e.preventDefault();
    const email = document.getElementById('regEmail').value.trim();
    const pass1 = document.getElementById('regPassword').value;
    const pass2 = document.getElementById('regPasswordConfirm').value;
    const msg = document.getElementById('registerMsg');

    if(pass1 !== pass2) {
      msg.textContent = 'كلمتا المرور غير متطابقتين.';
      msg.className = 'msg error';
      return;
    }
    if(pass1.length < 6) {
      msg.textContent = 'كلمة المرور يجب أن تكون 6 أحرف على الأقل.';
      msg.className = 'msg error';
      return;
    }
    let users = getUsers();
    if(users.some(u => u.email === email)) {
      msg.textContent = 'هذا البريد مستخدم مسبقاً.';
      msg.className = 'msg error';
      return;
    }
    users.push({email, password: pass1});
    saveUsers(users);
    msg.textContent = 'تم إنشاء الحساب بنجاح! يمكنك الآن تسجيل الدخول.';
    msg.className = 'msg success';
    e.target.reset();
  });

  // --- إضافة إعلان سيارة ---
  document.getElementById('addForm').addEventListener('submit', e => {
    e.preventDefault();
    if(!localStorage.getItem('userEmail')) {
      alert('يجب تسجيل الدخول لإضافة إعلان');
      showSection('loginSection');
      return;
    }
    const carName = document.getElementById('carName').value.trim();
    const price = parseInt(document.getElementById('price').value);
    const year = parseInt(document.getElementById('year').value);
    const mileage = parseInt(document.getElementById('mileage').value);
    const engine = parseInt(document.getElementById('engine').value);
    const transmission = document.getElementById('transmission').value;
    const fuel = document.getElementById('fuel').value;

    const msg = document.getElementById('addMsg');

    if(!carName || !price || !year || !mileage || !engine || !transmission || !fuel) {
      msg.textContent = 'يرجى ملء جميع الحقول بشكل صحيح.';
      msg.className = 'msg error';
      return;
    }
    if(year < 1900 || year > 2099) {
      msg.textContent = 'سنة الصنع غير صحيحة.';
      msg.className = 'msg error';
      return;
    }
    if(price <= 0 || mileage < 0 || engine < 50) {
      msg.textContent = 'برجاء إدخال أرقام صحيحة.';
      msg.className = 'msg error';
      return;
    }

    let cars = getCars();
    cars.push({carName, price, year, mileage, engine, transmission, fuel});
    saveCars(cars);

    msg.textContent = 'تم إضافة الإعلان بنجاح!';
    msg.className = 'msg success';
    e.target.reset();
    renderCarList();
    showSection('home');
  });

  // --- تهيئة الصفحة عند التحميل ---
  updateUI();
  renderCarList();
</script>

</body>
</html>
